# Util functions for ZSH


function lsdisk() {
    printf "Disk usage:\n"
    # List block devices excluding tmpfs, loop, and cdrom
    df -h -x tmpfs -x devtmpfs -x squashfs | awk '
        NR==1 {print; next} 
        /^\/dev\// {print}
    '
}

function lsports() {
    # Show all listening TCP/UDP ports with process and state info.
    if command -v ss &>/dev/null; then
        sudo ss -tulpn | awk '
            BEGIN {print "Proto\tState\tRecv-Q\tSend-Q\tLocal Address:Port\tProcess"}
            NR>1 {print $1"\t"$2"\t"$3"\t"$4"\t"$5"\t"$7}
        '
    elif command -v lsof &>/dev/null; then
        sudo lsof -i -P -n | awk '
            BEGIN {print "COMMAND\tPID\tUSER\tFD\tTYPE\tDEVICE\tSIZE/OFF\tNODE\tNAME"}
            /LISTEN/ {print}
        '
    else
        echo "Error: neither 'ss' nor 'lsof' found."
        return 1
    fi
}

